<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Publications - Udaya Wijenayake</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="assets/css/style.css" />
</head>
<body>
  <svg xmlns="http://www.w3.org/2000/svg" style="display:none;">

    <symbol id="icon-scholar" viewBox="0 0 24 24">
      <path d="M12 3L2 8l10 5 10-5-10-5zm0 7l-8-4 8-4 8 4-8 4z"/>
      <path d="M6 11v5c0 3 3 5 6 5s6-2 6-5v-5l-6 3-6-3z"/>
    </symbol>

    <symbol id="icon-researchgate" viewBox="0 0 24 24">
      <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" fill="none"/>
      <text x="7.8" y="15.5" font-size="7" font-family="sans-serif" fill="currentColor">RG</text>
    </symbol>

    <symbol id="icon-linkedin" viewBox="0 0 24 24">
      <rect x="3" y="3" width="18" height="18" rx="3" ry="3" fill="none" stroke="currentColor" stroke-width="2"/>
      <circle cx="8" cy="8" r="1.5" fill="currentColor"/>
      <rect x="7" y="10" width="2" height="8" fill="currentColor"/>
      <path d="M12 10h2v1h.05c.28-.5 1.2-1.2 2.3-1.2 2.4 0 2.7 1.5 2.7 3.5v4h-2v-3.5c0-.9-.1-2-1.2-2s-1.5.8-1.5 1.9V18h-2V10z" fill="currentColor"/>
    </symbol>

    <symbol id="icon-x" viewBox="0 0 24 24">
      <path d="M4 4l6.6 8L4.5 20h2.2l5.4-6.2L17.4 20h2.3l-6-8 6-8h-2.2l-5.4 6.2L6.7 4H4z" />
    </symbol>

    <symbol id="icon-github" viewBox="0 0 24 24">
      <path d="M12 .5C5.6.5.5 5.6.5 12c0 5.1 3.3 9.4 7.9 10.9.6.1.8-.2.8-.6v-2c-3.2.7-3.9-1.4-3.9-1.4-.5-1.1-1.1-1.4-1.1-1.4-.9-.6.1-.6.1-.6 1 .1 1.5 1 1.5 1 .9 1.5 2.3 1 2.8.8.1-.7.4-1.1.6-1.3-2.6-.3-5.3-1.3-5.3-5.7 0-1.2.4-2.2 1.1-3-.1-.3-.4-1.4.1-3 0 0 .9-.3 3 1.1.8-.2 1.6-.3 2.4-.3s1.7.1 2.5.3c2-1.4 3-1.1 3-1.1.5 1.6.2 2.7.1 3 .7.8 1.1 1.8 1.1 3 0 4.5-2.7 5.4-5.3 5.7.4.4.7 1.1.7 2.2v3.2c0 .3.2.7.8.6C20.2 21.3 23.5 17 23.5 12c0-6.4-5.1-11.5-11.5-11.5z"/>
    </symbol>

    <symbol id="icon-email" viewBox="0 0 24 24">
      <rect x="3" y="5" width="18" height="14" rx="2" ry="2" fill="none" stroke="currentColor" stroke-width="2"/>
      <polyline points="4,8 12,13 20,8" fill="none" stroke="currentColor" stroke-width="2"/>
    </symbol>

    <symbol id="icon-cv" viewBox="0 0 24 24">
      <path d="M7 2h8l5 5v15H7z" fill="none" stroke="currentColor" stroke-width="2"/>
      <polyline points="15,2 15,7 20,7" fill="none" stroke="currentColor" stroke-width="2"/>
      <line x1="9" y1="12" x2="15" y2="12" stroke="currentColor" stroke-width="2"/>
      <line x1="9" y1="15" x2="15" y2="15" stroke="currentColor" stroke-width="2"/>
      <line x1="9" y1="18" x2="13" y2="18" stroke="currentColor" stroke-width="2"/>
    </symbol>

  </svg>
    
  <header>
    <div class="container header-content">
      
      <div class="header-text-container"> 
        <h1>Udaya Wijenayake</h1>
        <p class="subtitle">
          Senior Lecturer, Department of Computer Engineering,<br />
          University of Sri Jayewardenepura, Sri Lanka
        </p>
        <p class="tags">
          Computer Vision · Image Processing · Machine Learning · Human–Computer Interaction
        </p>

        <div class="social-links">
          <a href="https://scholar.google.com/citations?hl=en&user=zZNLOAwAAAAJ"
            class="social-link" target="_blank" rel="noopener"
            aria-label="Google Scholar">
            <svg class="social-icon" viewBox="0 0 24 24">
              <use href="#icon-scholar"></use>
            </svg>
          </a>

          <a href="https://www.researchgate.net/profile/Udaya-Wijenayake"
            class="social-link" target="_blank" rel="noopener"
            aria-label="ResearchGate">
            <svg class="social-icon" viewBox="0 0 24 24">
              <use href="#icon-researchgate"></use>
            </svg>
          </a>

          <a href="https://www.linkedin.com/in/udaya-wijenayake-395749144/"
            class="social-link" target="_blank" rel="noopener"
            aria-label="LinkedIn">
            <svg class="social-icon" viewBox="0 0 24 24">
              <use href="#icon-linkedin"></use>
            </svg>
          </a>

          <a href="https://x.com/UdayaWijenayake"
            class="social-link" target="_blank" rel="noopener"
            aria-label="Twitter (X)">
            <svg class="social-icon" viewBox="0 0 24 24">
              <use href="#icon-x"></use>
            </svg>
          </a>

          <a href="https://github.com/udayawijenayake"
            class="social-link" target="_blank" rel="noopener"
            aria-label="GitHub">
            <svg class="social-icon" viewBox="0 0 24 24">
              <use href="#icon-github"></use>
            </svg>
          </a>

          <a href="mailto:udaya.ucsc@gmail.com"
            class="social-link" aria-label="Email">
            <svg class="social-icon" viewBox="0 0 24 24">
              <use href="#icon-email"></use>
            </svg>
          </a>

          <a href="assets/docs/Udaya_Wijenayake_CV.pdf"
            class="social-link" target="_blank" rel="noopener"
            aria-label="CV (PDF)">
            <svg class="social-icon" viewBox="0 0 24 24">
              <use href="#icon-cv"></use>
            </svg>
          </a>
        </div>
      </div>
      
      <div class="profile-pic-container"> 
        <img src="assets/img/profile.jpg" alt="Udaya Wijenayake" class="profile-pic" />
      </div>
    </div>

    <nav>
      <div class="container nav-links">
        <a href="index.html">Home</a>
        <a href="research.html">Research</a>
        <a href="publications.html" class="active-link">Publications</a>
        <a href="services.html">Services</a>
        <a href="teaching.html">Teaching</a>
        <a href="blogs.html">Blogs</a>
        <a href="contact.html">Contact</a>
      </div>
    </nav>
  </header>

  <main class="container">
     <section>
      <h2>Publications</h2>
      <p>
        You can view my complete profile on <a href="https://scholar.google.com/citations?hl=en&user=zZNLOAwAAAAJ" target="_blank">Google Scholar</a>.
      </p>
    </section>
    
    <section id="publications-root">
      <p>Loading publications…</p>
    </section>
  </main>

  <footer>
    <div class="container">
      <p>
        © <span data-year></span>
        Udaya Wijenayake · Department of Computer Engineering, University of Sri Jayewardenepura
      </p>
    </div>
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/@jonny/bibtex-parse-js@0.0.26/bibtexParse.js"></script>

  <script>
    // Set footer year using data-year attribute
    document.querySelector("[data-year]").textContent = new Date().getFullYear();

    // Human-friendly labels for BibTeX entry types
    const TYPE_LABELS = {
      article: "Journal Articles",
      inproceedings: "Conference Papers",
      incollection: "Book Chapters",
      proceedings: "Edited Proceedings",
      book: "Books",
      phdthesis: "PhD Theses",
      mastersthesis: "Master's Theses",
      techreport: "Technical Reports",
      misc: "Other Publications"
    };

    // Order in which sections appear
    const TYPE_ORDER = [
      "article",
      "inproceedings",
      "incollection",
      "proceedings",
      "book",
      "phdthesis",
      "mastersthesis",
      "techreport",
      "misc"
    ];

    async function loadPublications() {
      const root = document.getElementById("publications-root");

      try {
        const response = await fetch("publications.bib");
        if (!response.ok) {
          root.innerHTML = "<p>Could not load <code>publications.bib</code>. Ensure the file exists and is accessible.</p>";
          return;
        }

        const bibtexText = await response.text();
        const entries = bibtexParse.toJSON(bibtexText);

        const groupedByType = {};

        entries.forEach((entry) => {
            const type = (entry.entryType || "misc").toLowerCase();

            const rawTags = entry.entryTags || {};
            const tags = {};
            Object.keys(rawTags).forEach((key) => {
                tags[key.toLowerCase()] = rawTags[key];
            });

            entry._normTags = tags;

            if (!groupedByType[type]) groupedByType[type] = [];
            groupedByType[type].push(entry);
        });

        let html = "";

        TYPE_ORDER.forEach((type) => {
            if (!groupedByType[type]) return;

            // --- PASS 1: Calculate Chronological Number (Oldest=1, Newest=N) ---
            const allOfType = groupedByType[type];

            // 1. Sort all items of this type chronologically (oldest first)
            allOfType.sort((a, b) => {
                const yearA = parseInt(a._normTags.year, 10) || 0;
                const yearB = parseInt(b._normTags.year, 10) || 0;
                if (yearA !== yearB) return yearA - yearB;
                // Secondary sort: use title as a fallback chronological proxy
                return (a._normTags.title || '').localeCompare(b._normTags.title || '');
            });

            // 2. Assign Chronological Number
            allOfType.forEach((entry, index) => {
                entry._chronologicalNumber = index + 1;
            });

            // --- PASS 2: Render in Visual Order (Newest Year -> Newest Pub) ---
            const typeLabel = TYPE_LABELS[type] || type;
            html += `<section class="pub-section"><h2>${typeLabel}</h2>`;

            // Group by year again (with the new chronological number attached)
            const groupedByYear = {};
            allOfType.forEach(entry => {
                const year = entry._normTags.year || "No year";
                if (!groupedByYear[year]) groupedByYear[year] = [];
                groupedByYear[year].push(entry);
            });


            // Sort years DESCENDING (Newest year first: 2024, 2023, ...)
            const years = Object.keys(groupedByYear).sort((a, b) => {
                const na = parseInt(a, 10);
                const nb = parseInt(b, 10);
                if (isNaN(na) && isNaN(nb)) return b.localeCompare(a); 
                if (isNaN(na)) return 1;
                if (isNaN(nb)) return -1;
                return nb - na; // Descending sort (newest year first)
            });

            // Start the list container
            html += `<ul class="pub-list-manual">`;

            years.forEach((year) => {
                // Year heading displayed first within the list
                html += `<h3>${year}</h3>`; 

                let pubsInYear = groupedByYear[year];

                // Sort publications within the year DESCENDING (Newest first)
                pubsInYear.sort((a, b) => {
                    // Sort by the chronological number DESCENDING to show newest pubs first
                    return b._chronologicalNumber - a._chronologicalNumber;
                });

                pubsInYear.forEach((entry) => {
                    const t = entry._normTags || {};
                    const authors = t.author || "";
                    const title = t.title || "";
                    const journalOrBook =
                        t.journal || t.booktitle || t.school || t.howpublished || "";
                    const doi = t.doi || "";
                    const url = t.url || "";
                    const abstractUrl = t.abstracturl || "";

                    let venueStr = journalOrBook ? `<span class="pub-venue">${journalOrBook}</span>` : "";
                    let detailsParts = [];

                    if (t.volume) detailsParts.push("vol. " + t.volume);
                    if (t.number) detailsParts.push("no. " + t.number);
                    if (t.pages) detailsParts.push("pp. " + t.pages);

                    if (t["article-number"] && !t.pages) {
                        detailsParts.push("Article " + t["article-number"]);
                    }

                    const detailsStr = detailsParts.join(", ");
                    const links = [];

                    if (doi) {
                        links.push(`<a href="https://doi.org/${doi}" target="_blank">DOI</a>`);
                    } else if (url) {
                        links.push(`<a href="${url}" target="_blank">Link</a>`);
                    }
                    if (abstractUrl) {
                        links.push(`<a href="${abstractUrl}" target="_blank">Abstract</a>`);
                    }

                    // Manual number injection (Chronological, 1 to N)
                    const number = entry._chronologicalNumber; 
                    
                    html += `<li class="pub-item-manual">`;
                    html += `<span class="pub-number">${number}.</span>`; // Manually inject number
                    
                    // NEW: Wrap the entire publication citation into a content div
                    html += `<div class="pub-text-content">`;

                    // 1. Authors
                    if (authors) {
                        html += `<span class="pub-authors">${authors}</span>, `;
                    }
                    // 2. Title
                    if (title) {
                        html += `<span class="pub-title">“${title}”</span>`;
                    }
                    // 3. Venue
                    if (venueStr) {
                        html += `, ${venueStr}`;
                    }
                    // 4. Details (Vol, Pages, etc.)
                    if (detailsStr) {
                        html += `, <span class="pub-details">${detailsStr}</span>`;
                    }
                    // 5. Links
                    if (links.length > 0) {
                        html += ` <span class="pub-links"> | ${links.join(" | ")}</span>`;
                    }

                    html += `</div>`; // Close pub-text-content
                    html += "</li>";
                });
            });

            html += "</ul>"; // Close the list container
            html += "</section>";
        });

        if (!html) {
            html = "<p>No publications found in <code>publications.bib</code>.</p>";
        }

        root.innerHTML = html;
    } catch (err) {
        console.error(err);
        root.innerHTML = "<p>Error while loading publications. Check your console for details.</p>";
    }
}

loadPublications();
  </script>
</body>
</html>
